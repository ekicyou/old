<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>栞研究</title>
<script>
exports = {};
</script>
<script src="./debug/ieerbug.js?debug=true"></script>
<script src="./js/json2.js"></script>
<script src="./js/jquery-1.3.2.js"></script>
<script src="./js/taffy.js"></script>
<script src="./js/js.js"></script>
<script src="./js/util.js"></script>
<script src="./ranka/util.js"></script>
<script src="./ranka/jactor.js"></script>
<script src="./ranka/shiolink.js"></script>
<script src="./ranka/ranka.const.js"></script>
<script src="./ranka/ranka.talk.entry.js"></script>
<script src="./ranka/ranka.talk.slot.js"></script>
<script src="./ranka/ranka.talk.compile.js"></script>
<script src="./ranka/ranka.talk.sakurascript.js"></script>

<script src="./test/assets/jsunittest.js"></script>
<script src="./test/assets/sugar_test.js"></script>
<script src="./test/ranka.talk.test.js"></script>

<script>

// 呼び出すたびに行を返す
var testDataLines = null;
shiolink.readLine = function(){
  if( testDataLines == null ){
    testDataLines = INPUT_AREA.value.split("\n");
  }
  return testDataLines.shift();
}

shiolink.writeLine = function(line){
  console.warn("write:\n" + line );
}

// 試験
function test(){
  console.info("START TEST");
  while(true){
    var request = readRequest();
    if(request === null) break;
    console.warn("request:");
    console.warn(request);
    portRawShiori.send(request);
  }
  console.info("END TEST");
}
console.info(this);

// 試験2
function test2(){
  INPUT_AREA.value = hiTest;
}

</script>
</head>
<body>

<a href="#" onclick="test();return false;">TEST</a> |
<a href="#" onclick="test2();return false;">TEST2</a> |
<br />
<textarea id='INPUT_AREA' cols=80 rows=10 >
*L:loaddir
*S:59B5F4D5-57D8-418a-AC61-0BF4678CF1D0
GET Version SHIORI/2.6
Charset: UTF-8
Sender: SSP

*S:E8BEC7F4-B645-4cf1-90E1-66006253E698
GET SHIORI/3.0
ID: version
Charset: UTF-8
SecurityLevel: local
Sender: SSP

*S:775F7483-0CFB-44a9-BAF6-81EF2A29173D
GET SHIORI/3.0
Sender: SSP
Charset: UTF-8
SecurityLevel: local
ID: OnBoot
Reference0: しおリンク！

*S:950A94CC-EFCB-49b7-9BDA-5AB8006E6D88
NOTIFY SHIORI/3.0
Sender: SSP
Charset: UTF-8
SecurityLevel: local
ID: OnDestroy
Reference0:
Reference1: 1

*U:
</textarea><br />
<script type="text/javascript">
// <![CDATA[
SugarTest()
.run();
// ]]>
</script>

</body>
</html>